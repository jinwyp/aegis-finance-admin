<div class="item-margin breadcrumb-box">
    <ol class="breadcrumb">
        <li>审核管理</li>
        <li>&gt;</li>
        <li class="active">我的待办</li>
    </ol>
</div>

<process-tab [processInstanceId]="currentTask.processInstanceId" [processList]="currentOrder.taskList"></process-tab>

<div class="item-margin apply-box">

    <div class="table-title">融资申请</div>

    <div class="apply-title">
        <span *ngIf="currentTask.applyType==='MYR'">尽调报告-(应收)</span>
        <span *ngIf="currentTask.applyType!=='MYR'">尽调报告-(订单、仓押)</span>
        <div>
            <a [routerLink]="['/tasks', currentTask.id, 'trader']">查看申请材料</a>
            <span class="line"></span>
            <a [routerLink]="['/tasks', currentTask.id, 'salesman']">查看审批业务</a>
        </div>
    </div>

    <table class="table table-bordered apply-table">
        <tr class="item-max">
            <td class="td-label">业务类型:</td>
            <td width="250" class="td-val">{{currentTask.applyTypeName}}</td>
            <td class="td-label">业务编号:</td>
            <td width="250" class="td-val">{{currentTask.sourceId}}</td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span class="fs-16">项目主体信息</span></td>
        </tr>
        <tr class="item-max">
            <td class="td-label">融资方:</td>
            <td class="td-val">{{currentOrder.applyCompanyName}}</td>
            <td class="td-label">我方签约单位:</td>
            <td class="td-val">{{currentOrder.ourContractCompany}}</td>
        </tr>
        <!--应收字段-->
        <tr *ngIf="currentTask.applyType==='MYR'" class="item-max">
            <td class="td-label">下游签约单位:</td>
            <td class="td-val">{{currentOrder.downstreamContractCompany}}</td>
            <td class="td-label">终端用户:</td>
            <td class="td-val">{{currentOrder.terminalServer}}</td>
        </tr>
        <tr class="item-min">
            <td class="td-label">融资金额:</td>
            <td class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.financingAmount" placeholder="请输入">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.financingAmount}}</span>
            </td>
            <td class="td-label">融资期限:</td>
            <td class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.financingPeriod" placeholder="请输入">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.financingPeriod}}</span>
            </td>
        </tr>
        <tr class="item-min">
            <td class="td-label">利率:</td>
            <td class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.interestRate" placeholder="请输入">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.interestRate}}</span>
            </td>
            <td class="td-label">业务开展时间:</td>
            <td class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.businessStartTime" placeholder="请输入">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.businessStartTime}}</span>
            </td>
        </tr>
        <!--仓押字段-->
        <tr *ngIf="currentTask.applyType!=='MYR'" class="item-max">
            <td class="td-label">上游签约单位:</td>
            <!--<td class="td-val"><input type="text" [(ngModel)]="currentTask.upstreamContractCompany"></td>-->
            <td class="td-val">{{currentTask.upstreamContractCompany}}</td>
            <td class="td-label">下游签约单位:</td>
            <!--<td class="td-val"><input type="text" [(ngModel)]="currentTask.downstreamContractCompany"></td>-->
            <td class="td-val">{{currentTask.downstreamContractCompany}}</td>
        </tr>
        <tr *ngIf="currentTask.applyType!=='MYR'" class="item-max">
            <td class="td-label">运输方:</td>
            <!--<td class="td-val"><input type="text" [(ngModel)]="currentTask.transportParty"></td>-->
            <td class="td-val">{{currentTask.transportParty}}</td>
            <td class="td-label">中转港口:</td>
            <!--<td class="td-val"><input type="text" [(ngModel)]="currentTask.transitPort"></td>-->
            <td class="td-val">{{currentTask.transitPort}}</td>
        </tr>
        <tr *ngIf="currentTask.applyType!=='MYR'" class="item-max">
            <td class="td-label">质量检验单位:</td>
            <!--<td class="td-val"><input type="text" [(ngModel)]="currentTask.qualityInspectionUnit"></td>-->
            <td class="td-val">{{currentTask.qualityInspectionUnit}}</td>
            <td class="td-label">数量检验单位:</td>
            <!--<td class="td-val"><input type="text" [(ngModel)]="currentTask.quantityInspectionUnit"></td>-->
            <td class="td-val">{{currentTask.quantityInspectionUnit}}</td>
        </tr>

        <tr class="item-min">
            <td class="td-label">历史合作情况:</td>
            <td colspan="3" class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" class="describe" [(ngModel)]="currentOrder.historicalCooperationDetail">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.historicalCooperationDetail}}</span>
            </td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span class="fs-16">贸易链及描述</span></td>
        </tr>
        <tr class="item-min">
            <td class="td-label">业务主要信息:</td>
            <td colspan="3" class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.mainBusinessInfo">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.mainBusinessInfo}}</span>
            </td>
        </tr>
        <tr class="item-min">
            <td class="td-label">业务流转:</td>
            <td colspan="3" class="td-val">
                <input type="text" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.businessTransferInfo">
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.businessTransferInfo}}</span>
            </td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span class="fs-16">业务风险点<span class="fs-14 hint">(结合具体操作细节,对业务操作中的<span class="orange">可能风险点总结和提示</span>)</span></span></td>
        </tr>
        <tr class="item-min">
            <td class="td-val td-textarea" colspan="4">
                <textarea class="form-control" rows="2" placeholder="请输入" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.businessRiskPoint"></textarea>
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.businessRiskPoint}}</span>
            </td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span class="fs-16">履约信用及能力评估<span class="fs-14 hint">(结合相关签约主体的企业资信和实际煤炭贸易操作能力,对上下游相关方的<span class="orange">履约信用和能力描绘和评估</span>)</span></span></td>
        </tr>
        <tr class="item-min">
            <td class="td-val td-textarea" colspan="4">
                <textarea class="form-control" rows="2" placeholder="请输入" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.performanceCreditAbilityEval"></textarea>
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.performanceCreditAbilityEval}}</span>
            </td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span class="fs-16">综合意见<span class="fs-14 hint">(关于这单业务的最终综合意见和提示)</span></span></td>
        </tr>
        <tr class="item-min">
            <td class="td-val td-textarea" colspan="4">
                <textarea class="form-control" rows="2" placeholder="请输入" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.finalConclusion"></textarea>
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.finalConclusion}}</span>
            </td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span class="fs-16">附件上传<span class="fs-14 hint">(详细的风控报告和相关单据材料等,<span class="orange">5M之内</span>)</span></span></td>
        </tr>
        <tr class="item-max">
            <td class="td-val" colspan="4">
                <div class="attachment">
                    <img *ngFor="let pic of currentOrder.attachmentList" [src]="pic.url" [alt]="pic.name">
                    <file-upload *ngIf="css.isReadOnly===false" (onFinished)="finishedUpload($event)"></file-upload>
                </div>
            </td>
        </tr>
        <tr class="item-title">
            <td colspan="4"><span>是否需要补充材料的说明</span></td>
        </tr>
        <tr class="item-min">
            <td class="td-val td-textarea" colspan="4">
                <textarea class="form-control" rows="3" placeholder="请输入" *ngIf="css.isReadOnly===false" [(ngModel)]="currentOrder.supplyMaterialIntroduce"></textarea>
                <span class="span-read" *ngIf="css.isReadOnly===true">{{currentOrder.supplyMaterialIntroduce}}</span>
            </td>
        </tr>
        <!--<tr class="item-title">-->
            <!--<td colspan="4"><label><input type="checkbox">发送给业务人员</label><label><input type="checkbox">发送给用户</label></td>-->
        <!--</tr>-->
        <tr class="item-title">
            <td colspan="4">
                <span>审核意见:</span>
                <label><input type="radio" name="isApproved" [(ngModel)]="isApprovedRadio" [value]="1">通过</label>
                <label><input type="radio" name="isApproved" [(ngModel)]="isApprovedRadio" [value]="0">不通过</label>
                <!--<label><input type="radio" name="isApproved" [(ngModel)]="isApprovedRadio" [value]="2">让业务员补充尽调报告</label>-->
                <!--<label><input type="radio" name="isApproved" [(ngModel)]="isApprovedRadio" [value]="3">让业务员补充监管报告</label>-->
                <label><input type="radio" name="isApproved" [(ngModel)]="isApprovedRadio" [value]="4">让业务员补充尽调报告和监管报告</label>
            </td>
        </tr>
    </table>

    <div class="row info-item" *ngIf="css.isReadOnly===false">
        <div class="col-sm-offset-3 col-sm-6 mt-20">
            <div class="alert alert-success" role="alert" [class.hidden]="css.ajaxSuccessHidden">保存成功!</div>
            <div class="alert alert-danger" role="alert" [class.hidden]="css.ajaxErrorHidden">{{errorMsg}}!</div>
        </div>
        <div class="col-sm-12 info-val no-bottom-border center">
            <button type="button" class="btn btn-default btn-save" (click)="audit(false)" [disabled]="css.isSubmitted || currentTask.endTime">保存</button>
            <button type="button" class="btn btn-default btn-sure ml-20" (click)="audit(true)" [disabled]="css.isSubmitted || currentTask.endTime">保存并提交</button>
            <button type="button" class="btn btn-default btn-return ml-20" [routerLink]="['tasks/pending']">返回</button>
        </div>
    </div>
    <div class="row info-item" *ngIf="css.isReadOnly===true">
        <div class="col-sm-12 info-val no-bottom-border center">
            <button type="button" class="btn btn-default btn-lg btn-return ml-20" [routerLink]="['tasks/all']">返回</button>
        </div>
    </div>


</div>